"use strict";function _defineProperty(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}!function(e,o,t){var n,i=e.getElementsByTagName(o)[0];e.getElementById(t)||((n=e.createElement(o)).id=t,n.src="//connect.facebook.net/zh_TW/all.js#xfbml=1",i.parentNode.insertBefore(n,i),window.fbAsyncInit=function(){FB.init({appId:"1423502524421148",xfbml:!0,version:"v2.12"})})}(document,"script","facebook-jssdk");var menuCtrl={init:function(){var e=this;-1==location.href.indexOf("https")&&this.chkProtocol(),"IE8"!==this.chkIE8()?(menuCtrl.timesUp()&&$("header nav li").eq(3).removeClass("none"),this.timeStart()&&this.menuSet(),this.resize(),this.starSet(),menuCtrl.chkWebview()&&$(".warn").show(),$(window).on("resize",function(){e.resize(),e.starSet()})):location.href="ie8/"},timeStart:function(){var e=Date.parse("2018/04/30 00:00:00").valueOf();return Date.parse(new Date).valueOf()>=e},timesUp:function(){var e=Date.parse("2018/06/20 00:00:00").valueOf();return Date.parse(new Date).valueOf()>=e},menuSet:function(){var e=this;$(".menu").on("click",function(o){e.preventAll(o),$(this).toggleClass("open"),$("header nav").fadeToggle("fast")}),$("header p").css("cursor","pointer").on("click",function(o){e.preventAll(o),gaclick("menu_logo"),window.open("http://www.skm.com.tw/","_blank")}),$("header nav li").on("click",function(o){switch(e.preventAll(o),$(this).index()){case 0:trackWaitJump("menu_index","index.html");break;case 1:trackWaitJump("menu_rule","activity.html");break;case 2:trackWaitJump("menu_votelist","general.html");break;case 3:trackWaitJump("","award.html");break;case 4:gaclick("menu_fbshare"),e.shareFB();break;case 5:gaclick("menu_gshare"),e.shareGplus()}})},starSet:function(){var e=["one","two","three","four"],o=$(".main .meteor span");$(window).width()>600?$.each(o,function(o,t){$(t).addClass(e[o])}):$.each(o,function(o,t){$(t).removeClass(e[o])})},resize:function(){$(window).width()>600?($("header nav").show(),$(".menu").removeClass("open"),resizeFG=!1):($(".menu").hasClass("open")||$("header nav").hide(),resizeFG=!0)},preventAll:function(e){e.stopPropagation(),e.preventDefault()},fbLogin:function(e){var o=this;void 0!==e&&e.click(function(e){o.preventAll(e)}),gaclick("login_fb"),FB.login(function(e){"connected"===e.status&&FB.api("/me","GET",{fields:"id,name,email"},function(e){$.cookie("type","Facebook"),$.cookie("name",e.name),$.cookie("email",e.email),$.cookie("id",e.id),$.cookie("fb_login",!0),fb_login=!0,innerFG?$(".pop.login .close").click():$(".pop .close").click()})},{scope:"email"})},googleLogin:function(e){var o=this;gapi.load("auth2",function(){var t=gapi.auth2.init({clientId:"704654834388-3cclus6faj1vg3p9lenfdrd8pkbtq2gt.apps.googleusercontent.com"});e.on("click",function(e){o.preventAll(e),gaclick("login_google"),t.signIn().then(function(e){var o=e.getBasicProfile();o&&($.cookie("type","Google"),$.cookie("name",o.getName()),$.cookie("email",o.getEmail()),$.cookie("id",o.getId()),$.cookie("gplus_login",!0),gplus_login=!0,innerFG?$(".pop.login .close").click():$(".pop .close").click())})})})},shareFB:function(){var e,o=this.chkDevice()?"http://m.facebook.com/sharer.php?u=":"http://www.facebook.com/sharer.php?u=";e=location.href+"?fb_back=1",window.open(o+encodeURIComponent(e),"sharer","toolbar=0,status=0,width=656,height=436")},shareGplus:function(){var e;e=location.href+"?gplus_back=1",window.open("https://plus.google.com/share?url="+encodeURIComponent(e),"sharer","toolbar=0,status=0,width=656,height=436")},sendData:function(e){var o;if(void 0===e&&(e=null),menuCtrl.timesUp())alert("此投票活動已結束，感謝您的熱情參與！\n\n活動將於106年9月4日(一)抽獎\n得獎通知將於106年9月8日(五)以E-MAIL寄發通知\n\n請您密切注意，謝謝。");else{var t,n,i,a,c,r,l=grecaptcha.getResponse(),s=$(".read #checkbox-1").prop("checked");0!==l.length?s?(gaclick("vote_ok"),t=$.cookie("type"),n=$.cookie("name"),i=$.cookie("email")?$.cookie("email"):"",a=$.cookie("id"),c=$.cookie("choose1")+","+$.cookie("choose2")+","+$.cookie("choose3"),_defineProperty(o={type:t,name:n,email:i,uid:a},"type",t),_defineProperty(o,"choose",c),_defineProperty(o,"google",l),r=o,$.ajax({method:"POST",url:"../api/vote",data:r,success:function(o){"200"==o.status?($.removeCookie("choose1"),$.removeCookie("choose2"),$.removeCookie("choose3")):"110"==o.status&&$(".final_check .beenVote h2").text("您今日已投過票囉！"),e&&e()},error:function(e){alert("系統繁忙，請稍候再試，謝謝！")}})):alert("請閱讀並同意活動辦法及個人資料公開授權!"):alert("請使用google驗證!")}},chkDevice:function(e){var o=!1;return(isMobile.phone||isMobile.tablet||$(window).width()<=600&&1===e)&&(o=!0),o},chkWebview:function(){var e=window.navigator.userAgent.toLowerCase(),o=window.navigator.standalone,t=/safari/.test(e),n=/fbid|fbios|fblc|fb_iab|fb4a|fbav/.test(e),i=/line/i.test(e),a=!1;return/iphone|ipod|ipad/.test(e)&&(!o&&t||o&&!t||o||t||(a=!0)),a||n||i},chkIE8:function(){var e=navigator.userAgent,o=parseFloat(RegExp.$1);return-1!=e.indexOf("MSIE 6.0")?"IE6":7==o?"IE7":8==o?"IE8":9==o?"IE9":10==o?"IE10":e.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?"IE11":"0"},chkProtocol:function(){var e=location.href;e=e?e.replace("http","https"):location.href,"192.168.123.30"!=location.hostname&&"cell.webgene.com.tw"!=location.hostname&&(location.href=e)}};$(function(){menuCtrl.init()});